# クラウドスキャンロードマップ
## 1.概　要
- **クラウドスキャンとは何か**
  - 攻撃者がターゲット組織が使用しているクラウドシステムに対してスキャンを行うことを、大まかにクラウドスキャンという
  - クラウドスキャンは攻撃者にとって、**新たな課題**であると同時に、**新たな機会**をもたらす
  - MITRE ATT＆CKでは、クラウドスキャンを`ID T1046`の**ネットワークサービススキャン**に分類している
- **課　題**
  - **従来のスキャン技術を使えない**
    - クラウドプロバイダーは広範囲のIPアドレスをもっているため、それ**全てをスキャンすることは現実的ではない**
  - **ターゲットだと特定できない**
    - 仮にスキャンが出来たとしても、攻撃者はその結果がターゲットの情報なのか、同じクラウドプロバイダーの他の利用者なのか区別する方法がない
    - 例えばTCP/443で待ち受けてるこのIPアドレスは攻撃者のターゲットなのか、それとも他のクラウドの利用者なのか区別することができない
- **機　会**
  - **新たなターゲットの発見** 
    - 攻撃者はスキャンすることで特定のターゲットを区別することはできないが、さらなる**ターゲットを発見しそれを列挙**することができる
  - **監視や検知を回避できる**
    - クラウドスキャンは、ターゲット組織そのものにスキャニングするわけではないため、ターゲット組織により監視される**ログに記録される可能性が低い**
    - 同じクラウドプロバイダーのネットワーク内からスキャンを行えば、**FWなどをバイパス**できる可能性がある
  - **さらなる情報の取得**
    - クラウドにスキャニングすることで、**クラウド以外のインフラに関する情報を取得**できる可能性もあり、攻撃者からすると**攻撃機会の範囲が広がる**
  
## 2.クラウドスキャンの流れ
- **クラウドプロバイダーを特定**
  - ターゲットが利用しているクラウドプロバイダーを特定する 
- **IPアドレスレンジの列挙**
  - ターゲットが利用しているクラウドプロバイダーが保有しているIPアドレスの範囲を特定する
  - 複数クラウドプロバイダーを利用している場合はIPを列挙する 
- **スキャン**
  - nmapではない効率的なスキャンツールを使用してスキャンを行う
- **ホストの特定**
  - スキャンした結果を分析しターゲットのホスト（サーバーなど含む）を特定する  
- **さらなる調査/収集**
  - さらに取得した情報を調査分析し情報を収集する 

## JSONファイルとJQコマンド
- 多くのクラウドプロバイダーは、資産のプロビジョニング、ユーザ管理、システム監視を行う際に、JSONファイルが広く使われている
  - AWS、Google Cloud Platform、Azure、及びその他多くのクラウドプロバイダーで使用されている
- JSONファイルは、ASCllベースであるため、grepやcut、awkやsedなどの一般的なテキスト処理ツールで処理をすることができるので便利
- またJSONファイルの処理に特化した`JQツール（JSON Queyツール）`というものがあり、JSONデータの解析、照会、編集などを行うことに優れている
- 使い方は慣れれば簡単で、複雑なJSONデータを読みやすい形式に変換することができるため、クラウドスキャンなどで得られた情報を処理するのにJQの使い方を覚えることが今後の課題のひとつである