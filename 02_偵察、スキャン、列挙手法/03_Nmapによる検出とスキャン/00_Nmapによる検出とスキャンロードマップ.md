# Nmapによる検出とスキャンのロードマップ
## 1.Nmapを使う攻撃者の視点
- 攻撃者はターゲット組織のネットワーク構成と実際に攻撃するシステム情報と攻撃できる脆弱性を把握したいと考える
- nmapはその中でネットワーク構成とシステム情報、あるいは脆弱性を把握することができるツールのひとつである
- nmapは、ポートスキャンツールとして紹介されることが多いが、ネットワークマッピングをする際にも有用なツールのひとつであるため攻撃に最適なツールである   
- ここでは、nmapを使ったネットワークマッピングの方法、システム情報収集の方法、脆弱性を収集する方法の3つに整理する

## 2.ガイドライン
- **ネットワークマッピング手法**
  - nmapのオプションにより実現
    - ネットワークディスカバリー
    - ホストディスカバリー 
- **システム情報収集**
  - nmapのオプションにより実現 
    - ポートスキャン
    - バージョンスキャン
- **脆弱性情報**
  - NSEにより実現
    - システムやサービスごとに専用のスクリプトがある     

## rootとユーザの実行結果の違い
- 結論からいうと、root（sudo）で実行した方がよい。
- 違いは以下の通り
  
| 項 目 | rootユーザ | 一般ユーザ| 備 考 |
| --- | --- | --- | --- |
| デフォルトのスキャンタイプ | SYNスキャン | Connectスキャン |  |
| ターゲットシステムへの影響（ポジティブ） | デフォルトではSYNスキャンで実行されるためハーフオープン接続になるため、ログに残りにくい | 通常の接続になるので、検知システムに検知されにくい |  |
| ターゲットシステムへの影響（ネガティブ） | ハーフオープン接続が異常の通信と見なされると、検知システムに検知される可能性がある | ちゃんとログに残る |  |
| 情報の取得制度 | より詳細で正確 | 取得できる情報が限定的な場合がある |  |
| 利用可能なスキャンタイプ | ほとんどのスキャンタイプが利用可能 | スキャンタイプの指定に一部制限がある場合がある |  |
| スキャン速度と効率 | 効率的かつ高速 | rootユーザに比べると劣る |  |
  